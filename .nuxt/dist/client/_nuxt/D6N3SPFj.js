import{aA as v,av as h}from"./BCKidhl8.js";function z({swiper:t,extendParams:g,emit:d,once:x}){g({freeMode:{enabled:!1,momentum:!0,momentumRatio:1,momentumBounce:!0,momentumBounceRatio:1,momentumVelocityRatio:1,sticky:!1,minimumVelocity:.02}});function E(){if(t.params.cssMode)return;const l=t.getTranslate();t.setTranslate(l),t.setTransition(0),t.touchEventsData.velocities.length=0,t.freeMode.onTouchEnd({currentPos:t.rtl?t.translate:-t.translate})}function S(){if(t.params.cssMode)return;const{touchEventsData:l,touches:e}=t;l.velocities.length===0&&l.velocities.push({position:e[t.isHorizontal()?"startX":"startY"],time:l.touchStartTime}),l.velocities.push({position:e[t.isHorizontal()?"currentX":"currentY"],time:v()})}function B({currentPos:l}){if(t.params.cssMode)return;const{params:e,wrapperEl:f,rtlTranslate:r,snapGrid:i,touchEventsData:m}=t,b=v()-m.touchStartTime;if(l<-t.minTranslate()){t.slideTo(t.activeIndex);return}if(l>-t.maxTranslate()){t.slides.length<i.length?t.slideTo(i.length-1):t.slideTo(t.slides.length-1);return}if(e.freeMode.momentum){if(m.velocities.length>1){const n=m.velocities.pop(),a=m.velocities.pop(),R=n.position-a.position,y=n.time-a.time;t.velocity=R/y,t.velocity/=2,Math.abs(t.velocity)<e.freeMode.minimumVelocity&&(t.velocity=0),(y>150||v()-n.time>300)&&(t.velocity=0)}else t.velocity=0;t.velocity*=e.freeMode.momentumVelocityRatio,m.velocities.length=0;let s=1e3*e.freeMode.momentumRatio;const D=t.velocity*s;let o=t.translate+D;r&&(o=-o);let M=!1,c;const u=Math.abs(t.velocity)*20*e.freeMode.momentumBounceRatio;let T;if(o<t.maxTranslate())e.freeMode.momentumBounce?(o+t.maxTranslate()<-u&&(o=t.maxTranslate()-u),c=t.maxTranslate(),M=!0,m.allowMomentumBounce=!0):o=t.maxTranslate(),e.loop&&e.centeredSlides&&(T=!0);else if(o>t.minTranslate())e.freeMode.momentumBounce?(o-t.minTranslate()>u&&(o=t.minTranslate()+u),c=t.minTranslate(),M=!0,m.allowMomentumBounce=!0):o=t.minTranslate(),e.loop&&e.centeredSlides&&(T=!0);else if(e.freeMode.sticky){let n;for(let a=0;a<i.length;a+=1)if(i[a]>-o){n=a;break}Math.abs(i[n]-o)<Math.abs(i[n-1]-o)||t.swipeDirection==="next"?o=i[n]:o=i[n-1],o=-o}if(T&&x("transitionEnd",()=>{t.loopFix()}),t.velocity!==0){if(r?s=Math.abs((-o-t.translate)/t.velocity):s=Math.abs((o-t.translate)/t.velocity),e.freeMode.sticky){const n=Math.abs((r?-o:o)-t.translate),a=t.slidesSizesGrid[t.activeIndex];n<a?s=e.speed:n<2*a?s=e.speed*1.5:s=e.speed*2.5}}else if(e.freeMode.sticky){t.slideToClosest();return}e.freeMode.momentumBounce&&M?(t.updateProgress(c),t.setTransition(s),t.setTranslate(o),t.transitionStart(!0,t.swipeDirection),t.animating=!0,h(f,()=>{!t||t.destroyed||!m.allowMomentumBounce||(d("momentumBounce"),t.setTransition(e.speed),setTimeout(()=>{t.setTranslate(c),h(f,()=>{!t||t.destroyed||t.transitionEnd()})},0))})):t.velocity?(d("_freeModeNoMomentumRelease"),t.updateProgress(o),t.setTransition(s),t.setTranslate(o),t.transitionStart(!0,t.swipeDirection),t.animating||(t.animating=!0,h(f,()=>{!t||t.destroyed||t.transitionEnd()}))):t.updateProgress(o),t.updateActiveIndex(),t.updateSlidesClasses()}else if(e.freeMode.sticky){t.slideToClosest();return}else e.freeMode&&d("_freeModeNoMomentumRelease");(!e.freeMode.momentum||b>=e.longSwipesMs)&&(t.updateProgress(),t.updateActiveIndex(),t.updateSlidesClasses())}Object.assign(t,{freeMode:{onTouchStart:E,onTouchMove:S,onTouchEnd:B}})}export{z as f};
